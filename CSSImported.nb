(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42368,       1106]
NotebookOptionsPosition[     37528,       1040]
NotebookOutlinePosition[     37871,       1055]
CellTagsIndexPosition[     37828,       1052]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.759166612201*^9, 3.7591666235935397`*^9}, {
  3.759166764027189*^9, 3.7591667697818837`*^9}, {3.759270310282296*^9, 
  3.7592703116067963`*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"84d5aad2-0fab-4e2b-88aa-22681890b15e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", "\"\<test.css\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.759747241454134*^9, 3.759747248143989*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"1a579cb5-9099-4b5c-8bb3-981223a181f0"],

Cell[BoxData[
 RowBox[{"Import", "[", 
  RowBox[{"\"\<test.css\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<CSS\>\"", ",", "\"\<Elements\>\""}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7596913487732563`*^9, 3.759691359348199*^9}, {
  3.7597500087925916`*^9, 3.7597500155289693`*^9}, {3.7597501644700828`*^9, 
  3.7597501656572237`*^9}, {3.7597502541687527`*^9, 3.7597502550129642`*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"ea51b231-59a8-46d2-8165-6c15f81ba56f"],

Cell[BoxData[
 RowBox[{"s2", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"\"\<test.css\>\"", ",", "\"\<CSS\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759752081728298*^9, 3.759752090292074*^9}, {
  3.7597521628677835`*^9, 3.759752163068793*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"db6bf363-dbf5-4e2a-b997-e3b5c87a0d0e"],

Cell[CellGroupData[{

Cell["by hand", "Section",
 CellChangeTimes->{{3.7597472643820024`*^9, 
  3.7597472650951195`*^9}},ExpressionUUID->"d710f4e8-4986-4a4e-a80b-\
6d850468706d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"importText", "[", 
   RowBox[{"strm_InputStream", ",", 
    RowBox[{"encoding_:", "\"\<UTF8ISOLatin1\>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", ",", "bytes"}], "}"}], ",", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"Read", "[", 
       RowBox[{"strm", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "===", "$Failed"}], ",", 
       RowBox[{
        RowBox[{"Return", "@", "$Failed"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "===", "EndOfFile"}], ",", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"{", "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bytes", "=", 
      RowBox[{"ToCharacterCode", "[", "str", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"encoding", "===", "\"\<UTF8ISOLatin1\>\""}], ",", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"FromCharacterCode", "[", 
           RowBox[{"bytes", ",", "\"\<UTF8\>\""}], "]"}], ",", 
          RowBox[{"FromCharacterCode", "[", 
           RowBox[{"bytes", ",", "\"\<ISOLatin1\>\""}], "]"}]}], "]"}], ",", 
        RowBox[{"FromCharacterCode", "[", 
         RowBox[{"bytes", ",", "encoding"}], "]"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[477]:=",ExpressionUUID->"136c9b97-1555-4bae-8c33-7d2a459defca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"start", "=", "Now"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"importText", "[", 
    RowBox[{"OpenRead", "[", "\"\<test.css\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step2", "=", 
   RowBox[{"processRulesets", "[", "test", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"step3", "=", 
   RowBox[{"processDeclarations", "[", "step2", "]"}]}], ";"}], "\n", 
 RowBox[{"time", "=", 
  RowBox[{"Now", "-", "start"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", "step3", "]"}]}], "Input",
 CellChangeTimes->{{3.7591667954215603`*^9, 3.7591667962073517`*^9}, 
   3.759235361689288*^9, {3.7592703388499174`*^9, 3.759270349577236*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"19e15ec3-ce12-4ede-b3d0-edd6f5a2c841"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"Keys", "@", "propertyData"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.759168240174487*^9, {3.7592479823797913`*^9, 3.7592479908047*^9}},
 CellLabel->
  "In[526]:=",ExpressionUUID->"6f7d422b-581e-43fb-96e9-b9c650460e2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"start", "=", "Now"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"process", "[", 
       RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", "step3", ",", "s"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Now", "-", "start"}]}], "Input",
 CellChangeTimes->{{3.759166815752539*^9, 3.7591668216588726`*^9}, {
  3.7592705418119197`*^9, 3.75927055551229*^9}, {3.759270586363804*^9, 
  3.759270591321549*^9}},
 CellLabel->
  "In[751]:=",ExpressionUUID->"f355b703-eab9-47be-8b73-1b1da1c8f202"],

Cell[BoxData[
 RowBox[{"ds", "=", 
  RowBox[{"Dataset", "[", "s2", "]"}]}]], "Input",
 CellChangeTimes->{{3.759166822814789*^9, 3.7591668244202394`*^9}, {
  3.759168247988099*^9, 3.759168249597267*^9}, {3.7591714358021164`*^9, 
  3.7591714360218353`*^9}},
 CellLabel->
  "In[754]:=",ExpressionUUID->"f8da873b-b14d-403e-844d-9aa718fb2f05"],

Cell[BoxData[
 RowBox[{"temp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"s2", ",", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"#Selector", ",", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"{", "\"\<h3\>\"", "}"}]}]}], "]"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<Block\>\""}], "]"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.75967884886823*^9, 3.7596788859582796`*^9}, {
  3.759679235195235*^9, 3.7596792533432693`*^9}, {3.759680599167292*^9, 
  3.7596805996877337`*^9}},
 CellLabel->
  "In[535]:=",ExpressionUUID->"c45d6526-82c9-4550-8952-c5685510f03c"],

Cell[BoxData[
 RowBox[{"temp", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", " ", "\"\<Interpretation\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7596807690606117`*^9, 3.7596807740171347`*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"f762572e-132f-47bb-93b2-1bf36987604a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"temp", ",", " ", 
      RowBox[{
       RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], ",", " ", 
    RowBox[{"Select", "[", 
     RowBox[{"temp", ",", " ", 
      RowBox[{
       RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}]}], "]"}], 
  "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", " ", "\"\<Interpretation\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.759680647122488*^9, 3.7596806814238696`*^9}, {
  3.759680721488062*^9, 3.7596807447060037`*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"1029f713-f1b6-4e66-adbe-6106890490f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"interpretationList", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"s2", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "\"\<Block\>\"", ",", "All", ",", 
       "\"\<Interpretation\>\""}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Column", "[", 
   RowBox[{"interpretationList", "//", "Sort"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7595889467270494`*^9, 3.759588974449945*^9}, {
   3.759590707932613*^9, 3.7595907374087496`*^9}, {3.7595908595343246`*^9, 
   3.7595908634737434`*^9}, {3.759594012036764*^9, 3.75959402360297*^9}, {
   3.7595983105558796`*^9, 3.7595983278486767`*^9}, 3.759598825467951*^9},
 CellLabel->
  "In[489]:=",ExpressionUUID->"4c3317c5-a6dd-4b32-b08b-30721c1e234e"],

Cell[BoxData[
 RowBox[{"valid", " ", "=", " ", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{"interpretationList", ",", " ", 
    RowBox[{
     RowBox[{"_", "?", "FailureQ"}], " ", "|", " ", "_Missing"}], ",", " ", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7595940400990515`*^9, 3.7595940418029356`*^9}},
 CellLabel->
  "In[491]:=",ExpressionUUID->"409200e6-e622-4ee7-8eb5-105bc0b26a85"],

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{"valid", ",", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{"notebookLevelOptions", ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7595940780216007`*^9, 3.7595941151792536`*^9}},
 CellLabel->
  "In[492]:=",ExpressionUUID->"efb9f1f2-a73b-4355-9d7d-fc5c8d2c0843"],

Cell[BoxData[
 RowBox[{"valid", "=", 
  RowBox[{"Select", "[", 
   RowBox[{"valid", ",", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"cellLevelOptions", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759596776986557*^9, 3.7595967786926017`*^9}, {
  3.759597278574956*^9, 3.759597279118701*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"e1cc9ba8-b17f-4063-86a6-4ffb7b7c504f"]
}, Closed]],

Cell[CellGroupData[{

Cell["act on external HTML document", "Section",
 CellChangeTimes->{{3.759747283491478*^9, 
  3.7597472988009324`*^9}},ExpressionUUID->"e1c7cacf-742f-4b8c-822e-\
2b6e2ea112c7"],

Cell[BoxData[
 RowBox[{"ProcessCSSStylesAs", "[", 
  RowBox[{"Cell", ",", "s2", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<h3\>\"", ",", "\"\<h3:before\>\""}], "}"}], ",", 
   RowBox[{"\"\<IgnoreImportance\>\"", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7595335076637044`*^9, 3.7595335514331913`*^9}, {
   3.759682363479028*^9, 3.759682363712018*^9}, {3.759682493573683*^9, 
   3.759682496775984*^9}, 3.7596825827934327`*^9, {3.75975202564965*^9, 
   3.7597520278501825`*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"73849dc2-2029-48e4-86b6-b6106e439a8a"],

Cell[BoxData[
 RowBox[{"inheritedProperties", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Pick", "[", 
     RowBox[{
      RowBox[{"Keys", "@", "#"}], ",", 
      RowBox[{"Values", "@", "#"}]}], "]"}], "&"}], "@", 
   RowBox[{"CSSImport`Private`CSSPropertyData", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.75924306911678*^9, 3.7592430972112193`*^9}, {
  3.7592433197590494`*^9, 3.7592433795407996`*^9}, {3.7592514234589972`*^9, 
  3.7592514284504447`*^9}, {3.7597522010162516`*^9, 3.759752233732005*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"a26973ce-3730-46f6-8400-7a24573a2896"],

Cell["Load CSSSelectors3", "Text",
 CellChangeTimes->{{3.7592388927048006`*^9, 
  3.759238896219697*^9}},ExpressionUUID->"16ab7cae-dd26-4fb5-9cb3-\
300747b726ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"doc", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<index.html\>\"", ",", "\"\<XMLObject\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.759238752926736*^9, 3.7592387684628534`*^9}, {
   3.7592507145370617`*^9, 3.759250717175249*^9}, 3.7592508583477545`*^9, {
   3.7592534448657603`*^9, 3.7592534503440638`*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"00ebbdac-93d5-4669-aba4-e5f16f1917c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightDoc", "[", 
   RowBox[{
    RowBox[{"doc", ":", 
     RowBox[{
      RowBox[{"XMLObject", "[", "__", "]"}], "[", "__", "]"}]}], ",", 
    "loc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", "doc"}], "}"}], ",", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"d", ",", 
      RowBox[{"loc", "\[Rule]", 
       RowBox[{"Highlighted", "[", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"d", ",", "loc"}], "]"}], ",", 
         RowBox[{"Background", "\[Rule]", 
          RowBox[{"GrayLevel", "[", 
           RowBox[{"0", ",", "0.1"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.759518729515629*^9, 3.7595187581797314`*^9}, {
  3.759518803588599*^9, 3.7595188455775375`*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"571f453d-aee1-4916-9def-7f889310b4da"],

Cell["Get stylesheets from doc", "Text",
 CellChangeTimes->{{3.7598529187608485`*^9, 
  3.7598529233286543`*^9}},ExpressionUUID->"71d44925-6796-4fdc-9ac5-\
f749fb47af8f"],

Cell[BoxData[
 RowBox[{"directStyles", "=", 
  RowBox[{"Position", "[", 
   RowBox[{"doc", ",", 
    RowBox[{"XMLElement", "[", 
     RowBox[{"_", ",", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"\"\<style\>\"", "\[Rule]", "_"}], ",", "___"}], "}"}], ",", 
      "___"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759852945982462*^9, 3.7598529624389515`*^9}, {
  3.7598531863470182`*^9, 3.7598531882415934`*^9}, {3.7598532293640256`*^9, 
  3.759853245455892*^9}, {3.759853421004509*^9, 3.7598534420053177`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"c13612e8-4706-4ac5-895f-b280395d279e"],

Cell[BoxData[
 RowBox[{"\"\<style\>\"", "/.", 
  RowBox[{
   RowBox[{"Extract", "[", 
    RowBox[{"doc", ",", "directStyles"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759853429241807*^9, 3.75985346095864*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"909107b2-26a1-4414-9ee2-c649c55483af"],

Cell[BoxData[
 RowBox[{"raw", "=", 
  RowBox[{"{", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Selector\>\"", "\[Rule]", "\"\<\>\""}], ",", 
     RowBox[{"\"\<Condition\>\"", "\[Rule]", "\"\<\>\""}], ",", 
     RowBox[{"\"\<Block\>\"", "->", 
      RowBox[{"CSSImport`Private`processDeclarationBlock", "@", 
       RowBox[{
       "CSSImport`Private`parseDeclaration", "@", 
        "\"\<color:lightgreen\>\""}]}]}]}], "|>"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7598536114148593`*^9, 3.7598536612735887`*^9}, {
  3.759853698477005*^9, 3.759853709826008*^9}, {3.759853785873852*^9, 
  3.7598537927238317`*^9}, {3.759853834416168*^9, 3.759853864321925*^9}, {
  3.7598539032633677`*^9, 3.7598539034476986`*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"8b06f493-b2d9-4e08-9344-14c718e1b618"],

Cell[BoxData[
 RowBox[{"CSSImport`Private`validCSSDataQ", "[", "temp", "]"}]], "Input",
 CellChangeTimes->{{3.7598538678431063`*^9, 3.759853875153129*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"bf9eb474-6eb3-4935-ba0c-88142492b6dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uniqueStyles", " ", "=", " ", 
   RowBox[{"Union", " ", "@", " ", 
    RowBox[{"Flatten", " ", "@", " ", 
     RowBox[{"raw", "[", 
      RowBox[{"[", 
       RowBox[{
       "All", ",", " ", "\"\<Block\>\"", ",", " ", "All", ",", " ", 
        "\"\<Property\>\""}], "]"}], "]"}]}]}]}], ";", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CSSImport`Private`process", "[", 
      RowBox[{"#2", ",", " ", "#1"}], "]"}], "&"}], ",", " ", "raw", ",", " ",
     "uniqueStyles"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759853899354452*^9, 3.759853913121714*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"d9907522-9cbe-4add-be60-42f6de124cf9"],

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"doc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XMLElement", "[", 
     RowBox[{"\"\<style\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<text/css\>\""}], ",", "___"}],
        "}"}], ",", "___"}], "]"}], "|", 
    RowBox[{"XMLElement", "[", 
     RowBox[{"\"\<link\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"\"\<rel\>\"", "\[Rule]", "\"\<stylesheet\>\""}], ",", 
        RowBox[{"\"\<href\>\"", "\[Rule]", "\"\<test.css\>\""}]}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7598533127502675`*^9, 
  3.7598533890186234`*^9}},ExpressionUUID->"33c6a55c-71ed-42ca-8dce-\
136e34f3259d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", "=", 
         RowBox[{"Selector", "[", 
          RowBox[{"doc", ",", "#Selector"}], "]"}]}], "}"}], ",", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Selector\>\"", "->", "#Selector"}], ",", 
         RowBox[{"\"\<Specificity\>\"", "\[Rule]", 
          RowBox[{"t", "[", 
           RowBox[{"[", "\"\<Specificity\>\"", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Targets\>\"", "\[Rule]", 
          RowBox[{"t", "[", 
           RowBox[{"[", "\"\<Elements\>\"", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Condition\>\"", "->", "#Condition"}], ",", 
         RowBox[{"\"\<Block\>\"", "->", "#Block"}]}], "|>"}]}], "]"}], "&"}], 
    "/@", 
    RowBox[{"Normal", "@", "s2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s3", "=", 
   RowBox[{"s3", "[", 
    RowBox[{"[", 
     RowBox[{"Ordering", "[", 
      RowBox[{"s3", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Specificity\>\""}], "]"}], "]"}], "]"}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7592739631151953`*^9, 3.7592740011079717`*^9}, {
   3.7592740540865836`*^9, 3.759274063246643*^9}, 3.759274117772605*^9, {
   3.7597533588082037`*^9, 3.7597533599459105`*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"8aa3b9c2-cd1f-4af6-9c08-73e9f49f164a"],

Cell[BoxData[
 RowBox[{"ds", "=", 
  RowBox[{"Dataset", "[", "s3", "]"}]}]], "Input",
 CellChangeTimes->{{3.7592740758089657`*^9, 3.7592740806932354`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"fb5c91fa-44cf-4f7b-a63b-b68f5d3ad2a2"],

Cell[BoxData[
 RowBox[{"allSelectors", "=", 
  RowBox[{"s3", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "\"\<Selector\>\""}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7592388256688786`*^9, 3.7592388468022375`*^9}, {
  3.759274228173171*^9, 3.759274233137996*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"5f4b70e0-2f6c-47ee-bb37-4e5d10bceca2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{"s3", ",", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{"#Selector", ",", 
       RowBox[{"Alternatives", "@@", 
        RowBox[{"{", 
         RowBox[{"\"\<p\>\"", ",", "\"\<ul\>\""}], "}"}]}]}], "]"}], "&"}]}], 
   "]"}], "//", "Column"}]], "Input",
 CellChangeTimes->{{3.75968360072866*^9, 3.759683630509798*^9}, {
  3.75968369787432*^9, 3.7596837204336753`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"07d079ac-cbc4-473a-b774-cfcedd5cb6a4"],

Cell[BoxData[
 RowBox[{"elements", "=", 
  RowBox[{"Reverse", "@", 
   RowBox[{"Position", "[", 
    RowBox[{"doc", ",", "_XMLElement"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7592397932441607`*^9, 3.759239806610956*^9}, {
  3.7592742472489944`*^9, 3.759274251386999*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"fe272aa0-6f0b-469c-a6cb-79703321fe49"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"highlightDoc", "[", 
    RowBox[{"doc", ",", 
     RowBox[{"elements", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "elements", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.759518766340169*^9, 3.7595187932568207`*^9}, {
  3.759518931691764*^9, 3.759518945973311*^9}},
 CellLabel->
  "In[679]:=",ExpressionUUID->"95cf3754-60bb-47db-b616-d36d056dc585"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"<|", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "->", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<All\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Inherited\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"\"\<Computed\>\"", "\[Rule]", 
            RowBox[{"{", "}"}]}]}], "*)"}], "|>"}]}], "&"}], ",", 
      "elements"}], "]"}], "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.759274308344984*^9, 3.759274454613377*^9}, 
   3.7594439498272266`*^9, 3.7597542442194366`*^9},
 CellLabel->
  "In[297]:=",ExpressionUUID->"a1f583b7-5ca9-476a-b5f7-d9e73689674f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parents", "[", 
   RowBox[{"x", ":", 
    RowBox[{"{", "__Integer", "}"}]}], "]"}], ":=", 
  RowBox[{"Most", "@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"NestWhileList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{"#", ",", 
         RowBox[{"-", "2"}]}], "]"}], "&"}], ",", "x", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "#", "]"}], ">", "2"}], "&"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7592748024706974`*^9, 3.759274945843302*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"c02e547b-7879-45db-a898-45de31608942"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{
       RowBox[{"Pick", "[", 
        RowBox[{"s3", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"elements", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"s3", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "\"\<Targets\>\""}], "]"}], "]"}]}]}], "]"}], 
       "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Block\>\"", ",", "All", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Important\>\"", ",", "\"\<Property\>\"", ",", 
           "\"\<Interpretation\>\""}], "}"}]}], "]"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Key", "[", 
         RowBox[{"elements", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<All\>\""}], "]"}], 
      "]"}], "=", "temp"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Key", "[", 
         RowBox[{"elements", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<Inherited\>\""}], 
       "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"temp", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"inheritedProperties", ",", "#Property"}], "]"}], "&"}]}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Key", "[", 
          RowBox[{"elements", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<Computed\>\""}], 
        "]"}], "]"}], "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "@@", 
         RowBox[{"Values", "@", 
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Key", "/@", 
              RowBox[{"parents", "[", 
               RowBox[{"elements", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
             "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"temp", ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"inheritedProperties", ",", "#Property"}], "]"}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
       "]"}]}], ";"}], "*)"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.75944397352594*^9, 3.759444010278535*^9}, {
   3.759754098395732*^9, 3.7597541028605223`*^9}, 3.759754262710363*^9},
 CellLabel->
  "In[299]:=",ExpressionUUID->"633b23ed-f29f-47ac-9871-0c536a784d0a"],

Cell[BoxData[
 RowBox[{"a", "[", 
  RowBox[{"[", 
   RowBox[{"Key", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], "]"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7594440812384167`*^9, 3.759444093694475*^9}, {
  3.759507066784009*^9, 3.7595070744602213`*^9}, {3.759508214408661*^9, 
  3.759508214530637*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"397a72bb-7934-4369-8c44-db287ce7603a"],

Cell[BoxData[
 RowBox[{"Flatten", "@", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "@@", 
     RowBox[{"Values", "@", 
      RowBox[{"a", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Key", "/@", 
          RowBox[{"parents", "[", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
           "]"}]}], ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Key", "[", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
           "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Key", "[", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
           "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.759753666436539*^9, 3.759753669855755*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"9f445027-a2f0-487e-a543-2ba9e289aaa8"],

Cell[BoxData[
 RowBox[{"h3", "=", 
  RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
   RowBox[{"Cell", ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "@@", 
       RowBox[{"Values", "@", 
        RowBox[{"a", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Key", "/@", 
            RowBox[{"parents", "[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
             "]"}]}], ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Key", "[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
             "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Key", "[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
             "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.75951652236478*^9, 3.75951656433538*^9}, {
   3.7595168535300503`*^9, 3.7595168595930367`*^9}, {3.7595172285507507`*^9, 
   3.7595172562139006`*^9}, {3.7595174030966463`*^9, 3.759517415554344*^9}, {
   3.7595178264340534`*^9, 3.7595178420873837`*^9}, {3.7595179147894144`*^9, 
   3.7595179152894135`*^9}, {3.759518459800481*^9, 3.759518459862462*^9}, 
   3.7597534699321775`*^9, 3.7597537829509954`*^9},
 CellLabel->
  "In[1170]:=",ExpressionUUID->"1d3e4f3a-6044-4cbc-9e12-5a04ac98ee0e"],

Cell[BoxData[
 RowBox[{"h3", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<question\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"Values", "@", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Key", "/@", 
               RowBox[{"parents", "[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], 
                 "}"}], "]"}]}], ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", "[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], 
                 "}"}], "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", "[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], 
                 "}"}], "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7595185065789347`*^9, 3.7595185181263475`*^9}, {
   3.759518611738242*^9, 3.759518617623432*^9}, {3.7595186655944977`*^9, 
   3.7595186662092953`*^9}, 3.759519136115361*^9, 3.759519892124009*^9, 
   3.7597538091203175`*^9},
 CellLabel->
  "In[1160]:=",ExpressionUUID->"858a31bb-a132-493d-9a8e-3eb40fc32c78"],

Cell[BoxData[
 RowBox[{"li", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<li\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"Values", "@", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Key", "/@", 
               RowBox[{"parents", "[", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], "]"}]}], ",", 
              "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759518996197708*^9, 3.7595190001724777`*^9}, {
   3.759519055438472*^9, 3.7595190951191225`*^9}, 3.759753851455821*^9},
 CellLabel->
  "In[1161]:=",ExpressionUUID->"d73d831f-df15-4bef-9fd0-11d4980e9ca5"],

Cell[BoxData[
 RowBox[{"body", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<Notebook\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Notebook", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"Values", "@", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Key", "/@", 
               RowBox[{"parents", "[", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
              "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7595192624380465`*^9, 3.7595192871123557`*^9}, {
   3.759519331134688*^9, 3.759519331805464*^9}, 3.7597538524715357`*^9},
 CellLabel->
  "In[1162]:=",ExpressionUUID->"a443f03c-57c7-4d08-a02e-9b2ca34721da"],

Cell[CellGroupData[{

Cell["convert to specific box options", "Subsection",
 CellChangeTimes->{{3.7594433653898115`*^9, 
  3.759443374010498*^9}},ExpressionUUID->"a07000db-628e-4124-b2a7-\
df72af4ef85e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Names", "[", "\"\<*Box\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"opts", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Options", "[", 
         RowBox[{"Symbol", "[", "#", "]"}], "]"}], "&"}], "/@", "n"}]}], 
     "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"gg", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"Union", "[", 
         RowBox[{"opts", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"First", "/@", 
             RowBox[{"Position", "[", 
              RowBox[{"opts", ",", "#"}], "]"}]}], ",", "1"}], "]"}], "]"}], 
         "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "ImageSize", ",", "ImageSizeAction", ",", "ImageMargins", ",", 
       "FrameMargins", ",", "Frame", ",", "FrameStyle", ",", "Background", 
       ",", "Appearance", ",", "Alignment", ",", "FontTracking", ",", 
       "Spacings"}], "}"}]}]}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7593173066659613`*^9, 3.7593173657234287`*^9}, 
   3.759318218137082*^9, 3.759443327475321*^9, {3.7594434097456055`*^9, 
   3.7594434112637033`*^9}, {3.759506244325279*^9, 3.759506264963955*^9}, {
   3.7595063273286695`*^9, 3.75950633321655*^9}, {3.759591790168809*^9, 
   3.7595917910422325`*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"56d9cfa7-f17e-4ed1-955a-7ed236470ee5"],

Cell[BoxData["gg"], "Input",
 CellChangeTimes->{{3.7595906172566986`*^9, 3.759590617437657*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"722da79d-c635-49d3-8eb7-c03440df476e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, -967}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 399, 9, 28, "Input",ExpressionUUID->"84d5aad2-0fab-4e2b-88aa-22681890b15e"],
Cell[960, 31, 234, 5, 28, "Input",ExpressionUUID->"1a579cb5-9099-4b5c-8bb3-981223a181f0"],
Cell[1197, 38, 478, 9, 28, "Input",ExpressionUUID->"ea51b231-59a8-46d2-8165-6c15f81ba56f"],
Cell[1678, 49, 332, 7, 28, "Input",ExpressionUUID->"db6bf363-dbf5-4e2a-b997-e3b5c87a0d0e"],
Cell[CellGroupData[{
Cell[2035, 60, 156, 3, 67, "Section",ExpressionUUID->"d710f4e8-4986-4a4e-a80b-6d850468706d"],
Cell[2194, 65, 1701, 46, 105, "Input",ExpressionUUID->"136c9b97-1555-4bae-8c33-7d2a459defca"],
Cell[3898, 113, 820, 20, 124, "Input",ExpressionUUID->"19e15ec3-ce12-4ede-b3d0-edd6f5a2c841"],
Cell[4721, 135, 279, 7, 28, "Input",ExpressionUUID->"6f7d422b-581e-43fb-96e9-b9c650460e2a"],
Cell[5003, 144, 615, 16, 67, "Input",ExpressionUUID->"f355b703-eab9-47be-8b73-1b1da1c8f202"],
Cell[5621, 162, 338, 7, 28, "Input",ExpressionUUID->"f8da873b-b14d-403e-844d-9aa718fb2f05"],
Cell[5962, 171, 673, 18, 28, "Input",ExpressionUUID->"c45d6526-82c9-4550-8952-c5685510f03c"],
Cell[6638, 191, 285, 6, 28, "Input",ExpressionUUID->"f762572e-132f-47bb-93b2-1bf36987604a"],
Cell[6926, 199, 671, 18, 28, "Input",ExpressionUUID->"1029f713-f1b6-4e66-adbe-6106890490f4"],
Cell[7600, 219, 776, 18, 48, "Input",ExpressionUUID->"4c3317c5-a6dd-4b32-b08b-30721c1e234e"],
Cell[8379, 239, 415, 9, 30, "Input",ExpressionUUID->"409200e6-e622-4ee7-8eb5-105bc0b26a85"],
Cell[8797, 250, 399, 10, 28, "Input",ExpressionUUID->"efb9f1f2-a73b-4355-9d7d-fc5c8d2c0843"],
Cell[9199, 262, 475, 12, 28, "Input",ExpressionUUID->"e1cc9ba8-b17f-4063-86a6-4ffb7b7c504f"]
}, Closed]],
Cell[CellGroupData[{
Cell[9711, 279, 176, 3, 53, "Section",ExpressionUUID->"e1c7cacf-742f-4b8c-822e-2b6e2ea112c7"],
Cell[9890, 284, 576, 11, 28, "Input",ExpressionUUID->"73849dc2-2029-48e4-86b6-b6106e439a8a"],
Cell[10469, 297, 664, 15, 28, "Input",ExpressionUUID->"a26973ce-3730-46f6-8400-7a24573a2896"],
Cell[11136, 314, 162, 3, 34, "Text",ExpressionUUID->"16ab7cae-dd26-4fb5-9cb3-300747b726ce"],
Cell[11301, 319, 445, 10, 28, "Input",ExpressionUUID->"00ebbdac-93d5-4669-aba4-e5f16f1917c9"],
Cell[11749, 331, 907, 26, 48, "Input",ExpressionUUID->"571f453d-aee1-4916-9def-7f889310b4da"],
Cell[12659, 359, 170, 3, 34, "Text",ExpressionUUID->"71d44925-6796-4fdc-9ac5-f749fb47af8f"],
Cell[12832, 364, 624, 14, 28, "Input",ExpressionUUID->"c13612e8-4706-4ac5-895f-b280395d279e"],
Cell[13459, 380, 362, 9, 28, "Input",ExpressionUUID->"909107b2-26a1-4414-9ee2-c649c55483af"],
Cell[13824, 391, 803, 17, 67, "Input",ExpressionUUID->"8b06f493-b2d9-4e08-9344-14c718e1b618"],
Cell[14630, 410, 238, 4, 28, "Input",ExpressionUUID->"bf9eb474-6eb3-4935-ba0c-88142492b6dd"],
Cell[14871, 416, 694, 18, 48, "Input",ExpressionUUID->"d9907522-9cbe-4add-be60-42f6de124cf9"],
Cell[15568, 436, 788, 19, 68, "Input",ExpressionUUID->"33c6a55c-71ed-42ca-8dce-136e34f3259d"],
Cell[16359, 457, 1431, 37, 86, "Input",ExpressionUUID->"8aa3b9c2-cd1f-4af6-9c08-73e9f49f164a"],
Cell[17793, 496, 238, 5, 28, "Input",ExpressionUUID->"fb5c91fa-44cf-4f7b-a63b-b68f5d3ad2a2"],
Cell[18034, 503, 357, 8, 28, "Input",ExpressionUUID->"5f4b70e0-2f6c-47ee-bb37-4e5d10bceca2"],
Cell[18394, 513, 522, 14, 28, "Input",ExpressionUUID->"07d079ac-cbc4-473a-b774-cfcedd5cb6a4"],
Cell[18919, 529, 360, 8, 28, "Input",ExpressionUUID->"fe272aa0-6f0b-469c-a6cb-79703321fe49"],
Cell[19282, 539, 533, 14, 28, "Input",ExpressionUUID->"95cf3754-60bb-47db-b616-d36d056dc585"],
Cell[19818, 555, 776, 22, 28, "Input",ExpressionUUID->"a1f583b7-5ca9-476a-b5f7-d9e73689674f"],
Cell[20597, 579, 633, 19, 28, "Input",ExpressionUUID->"c02e547b-7879-45db-a898-45de31608942"],
Cell[21233, 600, 3207, 91, 200, "Input",ExpressionUUID->"633b23ed-f29f-47ac-9871-0c536a784d0a"],
Cell[24443, 693, 445, 11, 28, "Input",ExpressionUUID->"397a72bb-7934-4369-8c44-db287ce7603a"],
Cell[24891, 706, 1677, 47, 86, "Input",ExpressionUUID->"9f445027-a2f0-487e-a543-2ba9e289aaa8"],
Cell[26571, 755, 2237, 54, 105, "Input",ExpressionUUID->"1d3e4f3a-6044-4cbc-9e12-5a04ac98ee0e"],
Cell[28811, 811, 2364, 57, 124, "Input",ExpressionUUID->"858a31bb-a132-493d-9a8e-3eb40fc32c78"],
Cell[31178, 870, 2170, 54, 105, "Input",ExpressionUUID->"d73d831f-df15-4bef-9fd0-11d4980e9ca5"],
Cell[33351, 926, 2184, 54, 105, "Input",ExpressionUUID->"a443f03c-57c7-4d08-a02e-9b2ca34721da"],
Cell[CellGroupData[{
Cell[35560, 984, 181, 3, 53, "Subsection",ExpressionUUID->"a07000db-628e-4124-b2a7-df72af4ef85e"],
Cell[35744, 989, 1574, 42, 124, "Input",ExpressionUUID->"56d9cfa7-f17e-4ed1-955a-7ed236470ee5"],
Cell[37321, 1033, 179, 3, 28, "Input",ExpressionUUID->"722da79d-c635-49d3-8eb7-c03440df476e"]
}, Open  ]]
}, Open  ]]
}
]
*)

