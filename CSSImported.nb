(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31903,        855]
NotebookOptionsPosition[     28700,        808]
NotebookOutlinePosition[     29043,        823]
CellTagsIndexPosition[     29000,        820]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.759166612201*^9, 3.7591666235935397`*^9}, {
  3.759166764027189*^9, 3.7591667697818837`*^9}, {3.759270310282296*^9, 
  3.7592703116067963`*^9}},
 CellLabel->
  "In[476]:=",ExpressionUUID->"84d5aad2-0fab-4e2b-88aa-22681890b15e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"importText", "[", 
   RowBox[{"strm_InputStream", ",", 
    RowBox[{"encoding_:", "\"\<UTF8ISOLatin1\>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", ",", "bytes"}], "}"}], ",", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"Read", "[", 
       RowBox[{"strm", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "===", "$Failed"}], ",", 
       RowBox[{
        RowBox[{"Return", "@", "$Failed"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "===", "EndOfFile"}], ",", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"{", "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bytes", "=", 
      RowBox[{"ToCharacterCode", "[", "str", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"encoding", "===", "\"\<UTF8ISOLatin1\>\""}], ",", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"FromCharacterCode", "[", 
           RowBox[{"bytes", ",", "\"\<UTF8\>\""}], "]"}], ",", 
          RowBox[{"FromCharacterCode", "[", 
           RowBox[{"bytes", ",", "\"\<ISOLatin1\>\""}], "]"}]}], "]"}], ",", 
        RowBox[{"FromCharacterCode", "[", 
         RowBox[{"bytes", ",", "encoding"}], "]"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[477]:=",ExpressionUUID->"136c9b97-1555-4bae-8c33-7d2a459defca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"start", "=", "Now"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"importText", "[", 
    RowBox[{"OpenRead", "[", "\"\<test.css\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step2", "=", 
   RowBox[{"processRulesets", "[", "test", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"step3", "=", 
   RowBox[{"processDeclarations", "[", "step2", "]"}]}], ";"}], "\n", 
 RowBox[{"time", "=", 
  RowBox[{"Now", "-", "start"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", "step3", "]"}]}], "Input",
 CellChangeTimes->{{3.7591667954215603`*^9, 3.7591667962073517`*^9}, 
   3.759235361689288*^9, {3.7592703388499174`*^9, 3.759270349577236*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"19e15ec3-ce12-4ede-b3d0-edd6f5a2c841"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"Keys", "@", "propertyData"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.759168240174487*^9, {3.7592479823797913`*^9, 3.7592479908047*^9}},
 CellLabel->
  "In[484]:=",ExpressionUUID->"6f7d422b-581e-43fb-96e9-b9c650460e2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"start", "=", "Now"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"process", "[", 
       RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", "step3", ",", "s"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Now", "-", "start"}]}], "Input",
 CellChangeTimes->{{3.759166815752539*^9, 3.7591668216588726`*^9}, {
  3.7592705418119197`*^9, 3.75927055551229*^9}, {3.759270586363804*^9, 
  3.759270591321549*^9}},
 CellLabel->
  "In[485]:=",ExpressionUUID->"f355b703-eab9-47be-8b73-1b1da1c8f202"],

Cell[BoxData[
 RowBox[{"ds", "=", 
  RowBox[{"Dataset", "[", "s2", "]"}]}]], "Input",
 CellChangeTimes->{{3.759166822814789*^9, 3.7591668244202394`*^9}, {
  3.759168247988099*^9, 3.759168249597267*^9}, {3.7591714358021164`*^9, 
  3.7591714360218353`*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"f8da873b-b14d-403e-844d-9aa718fb2f05"],

Cell[CellGroupData[{

Cell["", "Section",ExpressionUUID->"e1c7cacf-742f-4b8c-822e-2b6e2ea112c7"],

Cell[BoxData[
 RowBox[{"ProcessAs", "[", 
  RowBox[{"Cell", ",", "ds", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<h3\>\"", ",", "\"\<h3:before\>\""}], "}"}], ",", 
   RowBox[{"\"\<IgnoreImportance\>\"", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7595335076637044`*^9, 3.7595335514331913`*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"73849dc2-2029-48e4-86b6-b6106e439a8a"],

Cell[BoxData[
 RowBox[{"stylesExample", "=", 
  RowBox[{"mergeStylesAs", "[", 
   RowBox[{"Cell", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<h3\>\"", ",", "\"\<h3:before\>\""}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.759248021942412*^9, 3.759248051140912*^9}, {
  3.759250491939665*^9, 3.7592504945088534`*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"b3108083-4fcc-41ce-87f9-dbdcef7fda24"],

Cell[BoxData[
 RowBox[{"CellPrint", "@", 
  RowBox[{"Cell", "[", 
   RowBox[{"\"\<AAAAA\>\"", ",", 
    RowBox[{"CellFrameColor", "\[Rule]", 
     RowBox[{"CurrentValue", "[", "FontColor", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", "stylesExample"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7592480454384203`*^9, 3.7592480587469983`*^9}, {
  3.75925056236796*^9, 3.7592506662069707`*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"021469cb-f035-4e9f-9df5-962c75227b9c"],

Cell[BoxData[
 RowBox[{"inheritedProperties", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Pick", "[", 
     RowBox[{
      RowBox[{"Keys", "@", "#"}], ",", 
      RowBox[{"Values", "@", "#"}]}], "]"}], "&"}], "@", 
   RowBox[{"propertyData", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.75924306911678*^9, 3.7592430972112193`*^9}, {
  3.7592433197590494`*^9, 3.7592433795407996`*^9}, {3.7592514234589972`*^9, 
  3.7592514284504447`*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"a26973ce-3730-46f6-8400-7a24573a2896"],

Cell["Load CSSSelectors3", "Text",
 CellChangeTimes->{{3.7592388927048006`*^9, 
  3.759238896219697*^9}},ExpressionUUID->"16ab7cae-dd26-4fb5-9cb3-\
300747b726ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"doc", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<index.html\>\"", ",", "\"\<XMLObject\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.759238752926736*^9, 3.7592387684628534`*^9}, {
   3.7592507145370617`*^9, 3.759250717175249*^9}, 3.7592508583477545`*^9, {
   3.7592534448657603`*^9, 3.7592534503440638`*^9}},
 CellLabel->
  "In[619]:=",ExpressionUUID->"00ebbdac-93d5-4669-aba4-e5f16f1917c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightDoc", "[", 
   RowBox[{
    RowBox[{"doc", ":", 
     RowBox[{
      RowBox[{"XMLObject", "[", "__", "]"}], "[", "__", "]"}]}], ",", 
    "loc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", "doc"}], "}"}], ",", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"d", ",", 
      RowBox[{"loc", "\[Rule]", 
       RowBox[{"Highlighted", "[", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"d", ",", "loc"}], "]"}], ",", 
         RowBox[{"Background", "\[Rule]", 
          RowBox[{"GrayLevel", "[", 
           RowBox[{"0", ",", "0.1"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.759518729515629*^9, 3.7595187581797314`*^9}, {
  3.759518803588599*^9, 3.7595188455775375`*^9}},
 CellLabel->
  "In[620]:=",ExpressionUUID->"571f453d-aee1-4916-9def-7f889310b4da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", "=", 
         RowBox[{"Selector", "[", 
          RowBox[{"doc", ",", "#Selector"}], "]"}]}], "}"}], ",", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Selector\>\"", "->", "#Selector"}], ",", 
         RowBox[{"\"\<Specificity\>\"", "\[Rule]", 
          RowBox[{"t", "[", 
           RowBox[{"[", "\"\<Specificity\>\"", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Targets\>\"", "\[Rule]", 
          RowBox[{"t", "[", 
           RowBox[{"[", "\"\<Elements\>\"", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Condition\>\"", "->", "#Condition"}], ",", 
         RowBox[{"\"\<Block\>\"", "->", "#Block"}]}], "|>"}]}], "]"}], "&"}], 
    "/@", "s2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s3", "=", 
   RowBox[{"s3", "[", 
    RowBox[{"[", 
     RowBox[{"Ordering", "[", 
      RowBox[{"s3", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Specificity\>\""}], "]"}], "]"}], "]"}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7592739631151953`*^9, 3.7592740011079717`*^9}, {
   3.7592740540865836`*^9, 3.759274063246643*^9}, 3.759274117772605*^9},
 CellLabel->
  "In[621]:=",ExpressionUUID->"8aa3b9c2-cd1f-4af6-9c08-73e9f49f164a"],

Cell[BoxData[
 RowBox[{"ds", "=", 
  RowBox[{"Dataset", "[", "s3", "]"}]}]], "Input",
 CellChangeTimes->{{3.7592740758089657`*^9, 3.7592740806932354`*^9}},
 CellLabel->
  "In[623]:=",ExpressionUUID->"fb5c91fa-44cf-4f7b-a63b-b68f5d3ad2a2"],

Cell[BoxData[
 RowBox[{"allSelectors", "=", 
  RowBox[{"s3", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "\"\<Selector\>\""}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7592388256688786`*^9, 3.7592388468022375`*^9}, {
  3.759274228173171*^9, 3.759274233137996*^9}},
 CellLabel->
  "In[576]:=",ExpressionUUID->"5f4b70e0-2f6c-47ee-bb37-4e5d10bceca2"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"highlightDoc", "[", 
    RowBox[{"doc", ",", 
     RowBox[{"elements", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "elements", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.759518766340169*^9, 3.7595187932568207`*^9}, {
  3.759518931691764*^9, 3.759518945973311*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"95cf3754-60bb-47db-b616-d36d056dc585"],

Cell[BoxData[
 RowBox[{"elements", "=", 
  RowBox[{"Reverse", "@", 
   RowBox[{"Position", "[", 
    RowBox[{"doc", ",", "_XMLElement"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7592397932441607`*^9, 3.759239806610956*^9}, {
  3.7592742472489944`*^9, 3.759274251386999*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"fe272aa0-6f0b-469c-a6cb-79703321fe49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"<|", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "->", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<All\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Inherited\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Computed\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "|>"}]}], "&"}], ",", "elements"}], "]"}], 
    "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.759274308344984*^9, 3.759274454613377*^9}, 
   3.7594439498272266`*^9},
 CellLabel->
  "In[578]:=",ExpressionUUID->"a1f583b7-5ca9-476a-b5f7-d9e73689674f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parents", "[", 
   RowBox[{"x", ":", 
    RowBox[{"{", "__Integer", "}"}]}], "]"}], ":=", 
  RowBox[{"Most", "@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"NestWhileList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{"#", ",", 
         RowBox[{"-", "2"}]}], "]"}], "&"}], ",", "x", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "#", "]"}], ">", "2"}], "&"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7592748024706974`*^9, 3.759274945843302*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"c02e547b-7879-45db-a898-45de31608942"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{
       RowBox[{"Pick", "[", 
        RowBox[{"s3", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"elements", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"s3", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "\"\<Targets\>\""}], "]"}], "]"}]}]}], "]"}], 
       "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Block\>\"", ",", "All", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Important\>\"", ",", "\"\<Property\>\"", ",", 
           "\"\<Interpretation\>\""}], "}"}]}], "]"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Key", "[", 
         RowBox[{"elements", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<All\>\""}], "]"}], 
      "]"}], "=", "temp"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Key", "[", 
         RowBox[{"elements", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<Inherited\>\""}], 
       "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"temp", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"inheritedProperties", ",", "#Property"}], "]"}], "&"}]}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Key", "[", 
         RowBox[{"elements", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<Computed\>\""}], 
       "]"}], "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Join", "@@", 
        RowBox[{"Values", "@", 
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Key", "/@", 
             RowBox[{"parents", "[", 
              RowBox[{"elements", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
            "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"temp", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"inheritedProperties", ",", "#Property"}], "]"}], "&"}]}],
          "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
      "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.75944397352594*^9, 3.759444010278535*^9}},
 CellLabel->
  "In[579]:=",ExpressionUUID->"633b23ed-f29f-47ac-9871-0c536a784d0a"],

Cell[BoxData[
 RowBox[{"a", "[", 
  RowBox[{"[", 
   RowBox[{"Key", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], "]"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7594440812384167`*^9, 3.759444093694475*^9}, {
  3.759507066784009*^9, 3.7595070744602213`*^9}, {3.759508214408661*^9, 
  3.759508214530637*^9}},
 CellLabel->
  "In[580]:=",ExpressionUUID->"397a72bb-7934-4369-8c44-db287ce7603a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Key", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], "]"}],
        ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7595173199084296`*^9, 3.7595173860028324`*^9}},
 CellLabel->
  "In[590]:=",ExpressionUUID->"9019c471-ee70-427e-9a08-67a3044ca747"],

Cell[BoxData[
 RowBox[{"h3", "=", 
  RowBox[{"processAs", "[", 
   RowBox[{"Cell", ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "@@", 
       RowBox[{"Values", "@", 
        RowBox[{"a", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Key", "/@", 
            RowBox[{"parents", "[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
             "]"}]}], ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Key", "[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
             "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Key", "[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
             "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.75951652236478*^9, 3.75951656433538*^9}, {
  3.7595168535300503`*^9, 3.7595168595930367`*^9}, {3.7595172285507507`*^9, 
  3.7595172562139006`*^9}, {3.7595174030966463`*^9, 3.759517415554344*^9}, {
  3.7595178264340534`*^9, 3.7595178420873837`*^9}, {3.7595179147894144`*^9, 
  3.7595179152894135`*^9}, {3.759518459800481*^9, 3.759518459862462*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"1d3e4f3a-6044-4cbc-9e12-5a04ac98ee0e"],

Cell[BoxData[
 RowBox[{"processAs", "[", 
  RowBox[{"Box", ",", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "@@", 
      RowBox[{"Values", "@", 
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Key", "/@", 
           RowBox[{"parents", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
            "]"}]}], ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Key", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
            "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Key", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], "}"}], 
            "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7595183733947873`*^9, 3.7595183745043173`*^9}},
 CellLabel->
  "In[597]:=",ExpressionUUID->"83cf9317-3aec-4225-8b9e-f372994d1348"],

Cell[BoxData[
 RowBox[{"h3", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<question\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"processAs", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"Values", "@", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Key", "/@", 
               RowBox[{"parents", "[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], 
                 "}"}], "]"}]}], ",", "\"\<Inherited\>\""}], "]"}], "]"}]}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", "[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], 
                 "}"}], "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", "[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "10"}], 
                 "}"}], "]"}], ",", "\"\<All\>\""}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7595185065789347`*^9, 3.7595185181263475`*^9}, {
   3.759518611738242*^9, 3.759518617623432*^9}, {3.7595186655944977`*^9, 
   3.7595186662092953`*^9}, 3.759519136115361*^9, 
   3.759519892124009*^9},ExpressionUUID->"858a31bb-a132-493d-9a8e-\
3eb40fc32c78"],

Cell[BoxData[
 RowBox[{"li", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<li\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"processAs", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"Values", "@", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Key", "/@", 
               RowBox[{"parents", "[", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], "]"}]}], ",", 
              "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759518996197708*^9, 3.7595190001724777`*^9}, {
  3.759519055438472*^9, 3.7595190951191225`*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"d73d831f-df15-4bef-9fd0-11d4980e9ca5"],

Cell[BoxData[
 RowBox[{"body", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<Notebook\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"processAs", "[", 
      RowBox[{"Notebook", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"Values", "@", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Key", "/@", 
               RowBox[{"parents", "[", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
              "\"\<Inherited\>\""}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Key", " ", "@", " ", 
                RowBox[{"elements", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], ",", "\"\<All\>\""}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Interpretation\>\""}], "]"}], "]"}]}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7595192624380465`*^9, 3.7595192871123557`*^9}, {
  3.759519331134688*^9, 3.759519331805464*^9}},
 CellLabel->
  "In[635]:=",ExpressionUUID->"a443f03c-57c7-4d08-a02e-9b2ca34721da"],

Cell[CellGroupData[{

Cell["convert to specific box options", "Subsection",
 CellChangeTimes->{{3.7594433653898115`*^9, 
  3.759443374010498*^9}},ExpressionUUID->"a07000db-628e-4124-b2a7-\
df72af4ef85e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Names", "[", "\"\<*Box\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"opts", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Options", "[", 
         RowBox[{"Symbol", "[", "#", "]"}], "]"}], "&"}], "/@", "n"}]}], 
     "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"gg", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"Union", "[", 
         RowBox[{"opts", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"First", "/@", 
             RowBox[{"Position", "[", 
              RowBox[{"opts", ",", "#"}], "]"}]}], ",", "1"}], "]"}], "]"}], 
         "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "ImageSize", ",", "ImageSizeAction", ",", "ImageMargins", ",", 
       "FrameMargins", ",", "Frame", ",", "FrameStyle", ",", "Background", 
       ",", "Appearance", ",", "Alignment", ",", "FontTracking"}], "}"}]}]}], 
   ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7593173066659613`*^9, 3.7593173657234287`*^9}, 
   3.759318218137082*^9, 3.759443327475321*^9, {3.7594434097456055`*^9, 
   3.7594434112637033`*^9}, {3.759506244325279*^9, 3.759506264963955*^9}, {
   3.7595063273286695`*^9, 3.75950633321655*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"56d9cfa7-f17e-4ed1-955a-7ed236470ee5"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1500, 917},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 399, 9, 28, "Input",ExpressionUUID->"84d5aad2-0fab-4e2b-88aa-22681890b15e"],
Cell[960, 31, 1701, 46, 105, "Input",ExpressionUUID->"136c9b97-1555-4bae-8c33-7d2a459defca"],
Cell[2664, 79, 820, 20, 124, "Input",ExpressionUUID->"19e15ec3-ce12-4ede-b3d0-edd6f5a2c841"],
Cell[3487, 101, 279, 7, 28, "Input",ExpressionUUID->"6f7d422b-581e-43fb-96e9-b9c650460e2a"],
Cell[3769, 110, 615, 16, 67, "Input",ExpressionUUID->"f355b703-eab9-47be-8b73-1b1da1c8f202"],
Cell[4387, 128, 338, 7, 28, "Input",ExpressionUUID->"f8da873b-b14d-403e-844d-9aa718fb2f05"],
Cell[CellGroupData[{
Cell[4750, 139, 74, 0, 67, "Section",ExpressionUUID->"e1c7cacf-742f-4b8c-822e-2b6e2ea112c7"],
Cell[4827, 141, 392, 8, 28, "Input",ExpressionUUID->"73849dc2-2029-48e4-86b6-b6106e439a8a"],
Cell[5222, 151, 408, 10, 28, "Input",ExpressionUUID->"b3108083-4fcc-41ce-87f9-dbdcef7fda24"],
Cell[5633, 163, 476, 10, 28, "Input",ExpressionUUID->"021469cb-f035-4e9f-9df5-962c75227b9c"],
Cell[6112, 175, 595, 15, 28, "Input",ExpressionUUID->"a26973ce-3730-46f6-8400-7a24573a2896"],
Cell[6710, 192, 162, 3, 34, "Text",ExpressionUUID->"16ab7cae-dd26-4fb5-9cb3-300747b726ce"],
Cell[6875, 197, 445, 10, 28, "Input",ExpressionUUID->"00ebbdac-93d5-4669-aba4-e5f16f1917c9"],
Cell[7323, 209, 907, 26, 28, "Input",ExpressionUUID->"571f453d-aee1-4916-9def-7f889310b4da"],
Cell[8233, 237, 1347, 35, 48, "Input",ExpressionUUID->"8aa3b9c2-cd1f-4af6-9c08-73e9f49f164a"],
Cell[9583, 274, 238, 5, 28, "Input",ExpressionUUID->"fb5c91fa-44cf-4f7b-a63b-b68f5d3ad2a2"],
Cell[9824, 281, 357, 8, 28, "Input",ExpressionUUID->"5f4b70e0-2f6c-47ee-bb37-4e5d10bceca2"],
Cell[10184, 291, 533, 14, 28, "Input",ExpressionUUID->"95cf3754-60bb-47db-b616-d36d056dc585"],
Cell[10720, 307, 360, 8, 28, "Input",ExpressionUUID->"fe272aa0-6f0b-469c-a6cb-79703321fe49"],
Cell[11083, 317, 695, 20, 28, "Input",ExpressionUUID->"a1f583b7-5ca9-476a-b5f7-d9e73689674f"],
Cell[11781, 339, 633, 19, 28, "Input",ExpressionUUID->"c02e547b-7879-45db-a898-45de31608942"],
Cell[12417, 360, 3006, 87, 124, "Input",ExpressionUUID->"633b23ed-f29f-47ac-9871-0c536a784d0a"],
Cell[15426, 449, 445, 11, 28, "Input",ExpressionUUID->"397a72bb-7934-4369-8c44-db287ce7603a"],
Cell[15874, 462, 625, 17, 28, "Input",ExpressionUUID->"9019c471-ee70-427e-9a08-67a3044ca747"],
Cell[16502, 481, 2148, 53, 105, "Input",ExpressionUUID->"1d3e4f3a-6044-4cbc-9e12-5a04ac98ee0e"],
Cell[18653, 536, 1779, 48, 105, "Input",ExpressionUUID->"83cf9317-3aec-4225-8b9e-f372994d1348"],
Cell[20435, 586, 2281, 56, 124, "Input",ExpressionUUID->"858a31bb-a132-493d-9a8e-3eb40fc32c78"],
Cell[22719, 644, 2114, 54, 105, "Input",ExpressionUUID->"d73d831f-df15-4bef-9fd0-11d4980e9ca5"],
Cell[24836, 700, 2126, 54, 105, "Input",ExpressionUUID->"a443f03c-57c7-4d08-a02e-9b2ca34721da"],
Cell[CellGroupData[{
Cell[26987, 758, 181, 3, 53, "Subsection",ExpressionUUID->"a07000db-628e-4124-b2a7-df72af4ef85e"],
Cell[27171, 763, 1501, 41, 86, "Input",ExpressionUUID->"56d9cfa7-f17e-4ed1-955a-7ed236470ee5"]
}, Open  ]]
}, Open  ]]
}
]
*)

