(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26125,        669]
NotebookOptionsPosition[     22394,        614]
NotebookOutlinePosition[     22766,        630]
CellTagsIndexPosition[     22723,        627]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.759166612201*^9, 3.7591666235935397`*^9}, {
  3.759166764027189*^9, 3.7591667697818837`*^9}, {3.759270310282296*^9, 
  3.7592703116067963`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"84d5aad2-0fab-4e2b-88aa-22681890b15e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", "\"\<test.css\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.759747241454134*^9, 3.759747248143989*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"1a579cb5-9099-4b5c-8bb3-981223a181f0"],

Cell[BoxData[
 RowBox[{"Import", "[", 
  RowBox[{"\"\<test.css\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<CSS\>\"", ",", "\"\<Elements\>\""}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7596913487732563`*^9, 3.759691359348199*^9}, {
  3.7597500087925916`*^9, 3.7597500155289693`*^9}, {3.7597501644700828`*^9, 
  3.7597501656572237`*^9}, {3.7597502541687527`*^9, 3.7597502550129642`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"ea51b231-59a8-46d2-8165-6c15f81ba56f"],

Cell[BoxData[
 RowBox[{"s2", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"\"\<test.css\>\"", ",", "\"\<CSS\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759752081728298*^9, 3.759752090292074*^9}, {
  3.7597521628677835`*^9, 3.759752163068793*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"db6bf363-dbf5-4e2a-b997-e3b5c87a0d0e"],

Cell[CellGroupData[{

Cell["by hand", "Section",
 CellChangeTimes->{{3.7597472643820024`*^9, 
  3.7597472650951195`*^9}},ExpressionUUID->"d710f4e8-4986-4a4e-a80b-\
6d850468706d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"importText", "[", 
   RowBox[{"strm_InputStream", ",", 
    RowBox[{"encoding_:", "\"\<UTF8ISOLatin1\>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", ",", "bytes"}], "}"}], ",", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"Read", "[", 
       RowBox[{"strm", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "===", "$Failed"}], ",", 
       RowBox[{
        RowBox[{"Return", "@", "$Failed"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "===", "EndOfFile"}], ",", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"{", "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bytes", "=", 
      RowBox[{"ToCharacterCode", "[", "str", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"encoding", "===", "\"\<UTF8ISOLatin1\>\""}], ",", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"FromCharacterCode", "[", 
           RowBox[{"bytes", ",", "\"\<UTF8\>\""}], "]"}], ",", 
          RowBox[{"FromCharacterCode", "[", 
           RowBox[{"bytes", ",", "\"\<ISOLatin1\>\""}], "]"}]}], "]"}], ",", 
        RowBox[{"FromCharacterCode", "[", 
         RowBox[{"bytes", ",", "encoding"}], "]"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[477]:=",ExpressionUUID->"136c9b97-1555-4bae-8c33-7d2a459defca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"start", "=", "Now"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"importText", "[", 
    RowBox[{"OpenRead", "[", "\"\<test.css\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step2", "=", 
   RowBox[{"processRulesets", "[", "test", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"step3", "=", 
   RowBox[{"processDeclarations", "[", "step2", "]"}]}], ";"}], "\n", 
 RowBox[{"time", "=", 
  RowBox[{"Now", "-", "start"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", "step3", "]"}]}], "Input",
 CellChangeTimes->{{3.7591667954215603`*^9, 3.7591667962073517`*^9}, 
   3.759235361689288*^9, {3.7592703388499174`*^9, 3.759270349577236*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"19e15ec3-ce12-4ede-b3d0-edd6f5a2c841"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"Keys", "@", "propertyData"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.759168240174487*^9, {3.7592479823797913`*^9, 3.7592479908047*^9}},
 CellLabel->
  "In[526]:=",ExpressionUUID->"6f7d422b-581e-43fb-96e9-b9c650460e2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"start", "=", "Now"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"process", "[", 
       RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", "step3", ",", "s"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Now", "-", "start"}]}], "Input",
 CellChangeTimes->{{3.759166815752539*^9, 3.7591668216588726`*^9}, {
  3.7592705418119197`*^9, 3.75927055551229*^9}, {3.759270586363804*^9, 
  3.759270591321549*^9}},
 CellLabel->
  "In[751]:=",ExpressionUUID->"f355b703-eab9-47be-8b73-1b1da1c8f202"],

Cell[BoxData[
 RowBox[{"ds", "=", 
  RowBox[{"Dataset", "[", "s2", "]"}]}]], "Input",
 CellChangeTimes->{{3.759166822814789*^9, 3.7591668244202394`*^9}, {
  3.759168247988099*^9, 3.759168249597267*^9}, {3.7591714358021164`*^9, 
  3.7591714360218353`*^9}},
 CellLabel->
  "In[754]:=",ExpressionUUID->"f8da873b-b14d-403e-844d-9aa718fb2f05"],

Cell[BoxData[
 RowBox[{"temp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"s2", ",", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"#Selector", ",", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"{", "\"\<h3\>\"", "}"}]}]}], "]"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<Block\>\""}], "]"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.75967884886823*^9, 3.7596788859582796`*^9}, {
  3.759679235195235*^9, 3.7596792533432693`*^9}, {3.759680599167292*^9, 
  3.7596805996877337`*^9}},
 CellLabel->
  "In[535]:=",ExpressionUUID->"c45d6526-82c9-4550-8952-c5685510f03c"],

Cell[BoxData[
 RowBox[{"temp", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", " ", "\"\<Interpretation\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7596807690606117`*^9, 3.7596807740171347`*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"f762572e-132f-47bb-93b2-1bf36987604a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"temp", ",", " ", 
      RowBox[{
       RowBox[{"#Important", "\[Equal]", "False"}], "&"}]}], "]"}], ",", " ", 
    RowBox[{"Select", "[", 
     RowBox[{"temp", ",", " ", 
      RowBox[{
       RowBox[{"#Important", "\[Equal]", "True"}], "&"}]}], "]"}]}], "]"}], 
  "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", " ", "\"\<Interpretation\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.759680647122488*^9, 3.7596806814238696`*^9}, {
  3.759680721488062*^9, 3.7596807447060037`*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"1029f713-f1b6-4e66-adbe-6106890490f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"interpretationList", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"s2", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "\"\<Block\>\"", ",", "All", ",", 
       "\"\<Interpretation\>\""}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Column", "[", 
   RowBox[{"interpretationList", "//", "Sort"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7595889467270494`*^9, 3.759588974449945*^9}, {
   3.759590707932613*^9, 3.7595907374087496`*^9}, {3.7595908595343246`*^9, 
   3.7595908634737434`*^9}, {3.759594012036764*^9, 3.75959402360297*^9}, {
   3.7595983105558796`*^9, 3.7595983278486767`*^9}, 3.759598825467951*^9},
 CellLabel->
  "In[489]:=",ExpressionUUID->"4c3317c5-a6dd-4b32-b08b-30721c1e234e"],

Cell[BoxData[
 RowBox[{"valid", " ", "=", " ", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{"interpretationList", ",", " ", 
    RowBox[{
     RowBox[{"_", "?", "FailureQ"}], " ", "|", " ", "_Missing"}], ",", " ", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7595940400990515`*^9, 3.7595940418029356`*^9}},
 CellLabel->
  "In[491]:=",ExpressionUUID->"409200e6-e622-4ee7-8eb5-105bc0b26a85"],

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{"valid", ",", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{"notebookLevelOptions", ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7595940780216007`*^9, 3.7595941151792536`*^9}},
 CellLabel->
  "In[492]:=",ExpressionUUID->"efb9f1f2-a73b-4355-9d7d-fc5c8d2c0843"],

Cell[BoxData[
 RowBox[{"valid", "=", 
  RowBox[{"Select", "[", 
   RowBox[{"valid", ",", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"cellLevelOptions", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759596776986557*^9, 3.7595967786926017`*^9}, {
  3.759597278574956*^9, 3.759597279118701*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"e1cc9ba8-b17f-4063-86a6-4ffb7b7c504f"]
}, Closed]],

Cell[CellGroupData[{

Cell["act on external HTML document", "Section",
 CellChangeTimes->{{3.759747283491478*^9, 
  3.7597472988009324`*^9}},ExpressionUUID->"e1c7cacf-742f-4b8c-822e-\
2b6e2ea112c7"],

Cell["Pick a document", "Text",
 CellChangeTimes->{{3.760014891419114*^9, 
  3.760014893847827*^9}},ExpressionUUID->"864d5ee1-dc03-4b72-ac41-\
48843ca5b097"],

Cell[BoxData[
 RowBox[{
  RowBox[{"doc", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<index.html\>\"", ",", "\"\<XMLObject\>\""}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"\"\<IncludeNamespaces\>\"", "\[Rule]", "True"}]}], "*)"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.759238752926736*^9, 3.7592387684628534`*^9}, {
   3.7592507145370617`*^9, 3.759250717175249*^9}, 3.7592508583477545`*^9, {
   3.7592534448657603`*^9, 3.7592534503440638`*^9}, 3.759955213851859*^9, 
   3.7599554516991816`*^9, {3.7599555644472046`*^9, 3.7599555664394703`*^9}, {
   3.7599555978668785`*^9, 3.7599556074350367`*^9}, 3.7599605729575844`*^9, 
   3.759961581934618*^9, 3.7599619770697193`*^9, 3.760013811660294*^9},
 CellLabel->
  "In[298]:=",ExpressionUUID->"00ebbdac-93d5-4669-aba4-e5f16f1917c9"],

Cell["Get stylesheets from doc", "Text",
 CellChangeTimes->{{3.7598529187608485`*^9, 
  3.7598529233286543`*^9}},ExpressionUUID->"71d44925-6796-4fdc-9ac5-\
f749fb47af8f"],

Cell[BoxData[
 RowBox[{"ds", "=", 
  RowBox[{"CSSImport`Private`ImportCSSFromXMLObject", "[", 
   RowBox[{"doc", ",", " ", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.760005243795117*^9, 3.760005248674183*^9}, {
   3.7600052988606977`*^9, 3.760005301739884*^9}, {3.7600058199174967`*^9, 
   3.760005822482415*^9}, {3.760006176988453*^9, 3.7600061806801143`*^9}, {
   3.7600062529081507`*^9, 3.7600063116076202`*^9}, {3.7600064939882746`*^9, 
   3.7600064958494415`*^9}, {3.76000721546249*^9, 3.760007219437189*^9}, {
   3.7600073653499174`*^9, 3.7600073688999443`*^9}, {3.7600138172491465`*^9, 
   3.7600138174692955`*^9}, 3.760013865524138*^9, {3.7600146503796687`*^9, 
   3.760014668397865*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"d36427a4-945d-4998-ac3d-11aea46509ed"],

Cell[BoxData[
 RowBox[{"elements", "=", 
  RowBox[{"Sort", "@", 
   RowBox[{"Position", "[", 
    RowBox[{"doc", ",", "_XMLElement"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7592397932441607`*^9, 3.759239806610956*^9}, {
  3.7592742472489944`*^9, 3.759274251386999*^9}, {3.760017124503643*^9, 
  3.7600171249981785`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"fe272aa0-6f0b-469c-a6cb-79703321fe49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"highlightDoc", "[", 
   RowBox[{
    RowBox[{"doc", ":", 
     RowBox[{
      RowBox[{"XMLObject", "[", "__", "]"}], "[", "__", "]"}]}], ",", 
    "loc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", "doc"}], "}"}], ",", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"d", ",", 
      RowBox[{"loc", "\[Rule]", 
       RowBox[{"Highlighted", "[", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"d", ",", "loc"}], "]"}], ",", 
         RowBox[{"Background", "\[Rule]", 
          RowBox[{"GrayLevel", "[", 
           RowBox[{"0", ",", "0.1"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"highlightDoc", "[", 
   RowBox[{
    RowBox[{"doc", ":", 
     RowBox[{
      RowBox[{"XMLObject", "[", "__", "]"}], "[", "__", "]"}]}], ",", 
    RowBox[{"loc", ":", 
     RowBox[{"{", "__List", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", "doc"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"d", ",", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"Highlighted", "[", 
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"d", ",", "#"}], "]"}], ",", 
              RowBox[{"Background", "\[Rule]", 
               RowBox[{"GrayLevel", "[", 
                RowBox[{"0", ",", "0.1"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
        ")"}], "&"}], "/@", "loc"}], ";", " ", "d"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759518729515629*^9, 3.7595187581797314`*^9}, {
  3.759518803588599*^9, 3.7595188455775375`*^9}, {3.7600156592905455`*^9, 
  3.76001572965919*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"571f453d-aee1-4916-9def-7f889310b4da"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"highlightDoc", "[", 
    RowBox[{"doc", ",", "j"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "elements"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759518766340169*^9, 3.7595187932568207`*^9}, {
  3.759518931691764*^9, 3.759518945973311*^9}, {3.7601388194070654`*^9, 
  3.760138838080964*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"95cf3754-60bb-47db-b616-d36d056dc585"],

Cell[BoxData[
 RowBox[{"h3", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<question\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"CSSImport`Private`resolveInheritance", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "6"}], "}"}], ",", 
         RowBox[{"Normal", "@", "ds"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7595185065789347`*^9, 3.7595185181263475`*^9}, {
   3.759518611738242*^9, 3.759518617623432*^9}, {3.7595186655944977`*^9, 
   3.7595186662092953`*^9}, 3.759519136115361*^9, 3.759519892124009*^9, 
   3.7597538091203175`*^9, 3.76013756490691*^9, 3.7601392618090935`*^9},
 CellLabel->
  "In[317]:=",ExpressionUUID->"858a31bb-a132-493d-9a8e-3eb40fc32c78"],

Cell[BoxData[
 RowBox[{"h3special", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", 
     RowBox[{"\"\<questionSpecial\>\"", ",", " ", 
      RowBox[{"StyleDefinitions", "\[Rule]", 
       RowBox[{"StyleData", "[", "\"\<question\>\"", "]"}]}]}], "]"}], ","}], 
   RowBox[{"(*", "TODO", "*)"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601389732256365`*^9, 3.760139023025508*^9}, {
  3.760139581290433*^9, 
  3.7601395828587866`*^9}},ExpressionUUID->"66a1bb1a-795d-41d9-98b7-\
10bc716f0f0b"],

Cell[BoxData[
 RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
  RowBox[{"Cell", ",", "\[IndentingNewLine]", 
   RowBox[{"CSSImport`Private`resolveInheritance", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "14"}], "}"}], ",", 
     RowBox[{"Normal", "@", "ds"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.760139062114109*^9, 3.7601390635259943`*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"3dd5b7c1-4f9f-436c-9e41-3f4da3fab52b"],

Cell[BoxData[
 RowBox[{"li", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<li\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"CSSImport`Private`resolveInheritance", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "2", ",", "3", ",", "2", ",", "3", ",", "20", ",", "3", ",", "1"}], 
          "}"}], ",", 
         RowBox[{"Normal", "@", "ds"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.759518996197708*^9, 3.7595190001724777`*^9}, {
   3.759519055438472*^9, 3.7595190951191225`*^9}, 3.759753851455821*^9, {
   3.7601378414197254`*^9, 3.760137845449692*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"d73d831f-df15-4bef-9fd0-11d4980e9ca5"],

Cell[BoxData[
 RowBox[{"body", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<Notebook\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Notebook", ",", "\[IndentingNewLine]", 
       RowBox[{"CSSImport`Private`resolveInheritance", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2"}], "}"}], ",", 
         RowBox[{"Normal", "@", "ds"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7595192624380465`*^9, 3.7595192871123557`*^9}, {
   3.759519331134688*^9, 3.759519331805464*^9}, 3.7597538524715357`*^9, {
   3.760137905925769*^9, 3.760137908906521*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"a443f03c-57c7-4d08-a02e-9b2ca34721da"],

Cell[BoxData[
 RowBox[{"p", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<p\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"CSSImport`Private`resolveInheritance", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "8"}], "}"}], ",", 
         RowBox[{"Normal", "@", "ds"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.76013794619331*^9, 3.7601379523288383`*^9}, 
   3.760138280739032*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"ba258521-f7ff-4dca-a5b8-60a7caa06f10"],

Cell[BoxData[
 RowBox[{"h2", "=", 
  RowBox[{"Cell", "[", 
   RowBox[{
    RowBox[{"StyleData", "[", "\"\<h2\>\"", "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"CSSImport`Private`mergeInterpretationList", "[", 
      RowBox[{"Cell", ",", "\[IndentingNewLine]", 
       RowBox[{"CSSImport`Private`resolveInheritance", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"Normal", "@", "ds"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7601379787798476`*^9, 3.760137986568147*^9}, {
  3.7601382829177213`*^9, 3.76013828298003*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"e1eba982-65cc-4f3a-ace4-7418dffaafdf"],

Cell[BoxData[
 RowBox[{"NotebookPut", "@", 
  RowBox[{"Notebook", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cell", "[", 
       RowBox[{"StyleData", "[", 
        RowBox[{"StyleDefinitions", "\[Rule]", "\"\<Default.nb\>\""}], "]"}], 
       "]"}], ",", "body", ",", "h2", ",", "h3", ",", "p", ",", "li"}], "}"}],
     ",", 
    RowBox[{
    "StyleDefinitions", "\[Rule]", 
     "\"\<PrivateStylesheetFormatting.nb\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601382969666023`*^9, 3.760138323953228*^9}, {
  3.76013843281765*^9, 3.760138464824204*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"1248611e-a9d8-41ee-a015-93788e55d4ad"],

Cell[CellGroupData[{

Cell["convert to specific box options", "Subsection",
 CellChangeTimes->{{3.7594433653898115`*^9, 
  3.759443374010498*^9}},ExpressionUUID->"a07000db-628e-4124-b2a7-\
df72af4ef85e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Names", "[", "\"\<*Box\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"opts", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Options", "[", 
         RowBox[{"Symbol", "[", "#", "]"}], "]"}], "&"}], "/@", "n"}]}], 
     "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"gg", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"Union", "[", 
         RowBox[{"opts", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"First", "/@", 
             RowBox[{"Position", "[", 
              RowBox[{"opts", ",", "#"}], "]"}]}], ",", "1"}], "]"}], "]"}], 
         "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "ImageSize", ",", "ImageSizeAction", ",", "ImageMargins", ",", 
       "FrameMargins", ",", "Frame", ",", "FrameStyle", ",", "Background", 
       ",", "Appearance", ",", "Alignment", ",", "FontTracking", ",", 
       "Spacings"}], "}"}]}]}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7593173066659613`*^9, 3.7593173657234287`*^9}, 
   3.759318218137082*^9, 3.759443327475321*^9, {3.7594434097456055`*^9, 
   3.7594434112637033`*^9}, {3.759506244325279*^9, 3.759506264963955*^9}, {
   3.7595063273286695`*^9, 3.75950633321655*^9}, {3.759591790168809*^9, 
   3.7595917910422325`*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"56d9cfa7-f17e-4ed1-955a-7ed236470ee5"],

Cell[BoxData["gg"], "Input",
 CellChangeTimes->{{3.7595906172566986`*^9, 3.759590617437657*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"722da79d-c635-49d3-8eb7-c03440df476e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1484, 917},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 399, 9, 37, "Input",ExpressionUUID->"84d5aad2-0fab-4e2b-88aa-22681890b15e"],
Cell[960, 31, 234, 5, 37, "Input",ExpressionUUID->"1a579cb5-9099-4b5c-8bb3-981223a181f0"],
Cell[1197, 38, 478, 9, 37, "Input",ExpressionUUID->"ea51b231-59a8-46d2-8165-6c15f81ba56f"],
Cell[1678, 49, 332, 7, 37, "Input",ExpressionUUID->"db6bf363-dbf5-4e2a-b997-e3b5c87a0d0e"],
Cell[CellGroupData[{
Cell[2035, 60, 156, 3, 84, "Section",ExpressionUUID->"d710f4e8-4986-4a4e-a80b-6d850468706d"],
Cell[2194, 65, 1701, 46, 387, "Input",ExpressionUUID->"136c9b97-1555-4bae-8c33-7d2a459defca"],
Cell[3898, 113, 820, 20, 459, "Input",ExpressionUUID->"19e15ec3-ce12-4ede-b3d0-edd6f5a2c841"],
Cell[4721, 135, 279, 7, 101, "Input",ExpressionUUID->"6f7d422b-581e-43fb-96e9-b9c650460e2a"],
Cell[5003, 144, 615, 16, 248, "Input",ExpressionUUID->"f355b703-eab9-47be-8b73-1b1da1c8f202"],
Cell[5621, 162, 338, 7, 101, "Input",ExpressionUUID->"f8da873b-b14d-403e-844d-9aa718fb2f05"],
Cell[5962, 171, 673, 18, 101, "Input",ExpressionUUID->"c45d6526-82c9-4550-8952-c5685510f03c"],
Cell[6638, 191, 285, 6, 101, "Input",ExpressionUUID->"f762572e-132f-47bb-93b2-1bf36987604a"],
Cell[6926, 199, 671, 18, 101, "Input",ExpressionUUID->"1029f713-f1b6-4e66-adbe-6106890490f4"],
Cell[7600, 219, 776, 18, 175, "Input",ExpressionUUID->"4c3317c5-a6dd-4b32-b08b-30721c1e234e"],
Cell[8379, 239, 415, 9, 109, "Input",ExpressionUUID->"409200e6-e622-4ee7-8eb5-105bc0b26a85"],
Cell[8797, 250, 399, 10, 101, "Input",ExpressionUUID->"efb9f1f2-a73b-4355-9d7d-fc5c8d2c0843"],
Cell[9199, 262, 475, 12, 101, "Input",ExpressionUUID->"e1cc9ba8-b17f-4063-86a6-4ffb7b7c504f"]
}, Closed]],
Cell[CellGroupData[{
Cell[9711, 279, 176, 3, 65, "Section",ExpressionUUID->"e1c7cacf-742f-4b8c-822e-2b6e2ea112c7"],
Cell[9890, 284, 157, 3, 44, "Text",ExpressionUUID->"864d5ee1-dc03-4b72-ac41-48843ca5b097"],
Cell[10050, 289, 810, 16, 37, "Input",ExpressionUUID->"00ebbdac-93d5-4669-aba4-e5f16f1917c9"],
Cell[10863, 307, 170, 3, 44, "Text",ExpressionUUID->"71d44925-6796-4fdc-9ac5-f749fb47af8f"],
Cell[11036, 312, 825, 14, 37, "Input",ExpressionUUID->"d36427a4-945d-4998-ac3d-11aea46509ed"],
Cell[11864, 328, 408, 9, 37, "Input",ExpressionUUID->"fe272aa0-6f0b-469c-a6cb-79703321fe49"],
Cell[12275, 339, 1904, 55, 88, "Input",ExpressionUUID->"571f453d-aee1-4916-9def-7f889310b4da"],
Cell[14182, 396, 460, 11, 37, "Input",ExpressionUUID->"95cf3754-60bb-47db-b616-d36d056dc585"],
Cell[14645, 409, 945, 20, 88, "Input",ExpressionUUID->"858a31bb-a132-493d-9a8e-3eb40fc32c78"],
Cell[15593, 431, 515, 12, 37, "Input",ExpressionUUID->"66a1bb1a-795d-41d9-98b7-10bc716f0f0b"],
Cell[16111, 445, 499, 10, 63, "Input",ExpressionUUID->"3dd5b7c1-4f9f-436c-9e41-3f4da3fab52b"],
Cell[16613, 457, 857, 20, 63, "Input",ExpressionUUID->"d73d831f-df15-4bef-9fd0-11d4980e9ca5"],
Cell[17473, 479, 806, 18, 63, "Input",ExpressionUUID->"a443f03c-57c7-4d08-a02e-9b2ca34721da"],
Cell[18282, 499, 711, 17, 63, "Input",ExpressionUUID->"ba258521-f7ff-4dca-a5b8-60a7caa06f10"],
Cell[18996, 518, 738, 17, 63, "Input",ExpressionUUID->"e1eba982-65cc-4f3a-ace4-7418dffaafdf"],
Cell[19737, 537, 664, 17, 37, "Input",ExpressionUUID->"1248611e-a9d8-41ee-a015-93788e55d4ad"],
Cell[CellGroupData[{
Cell[20426, 558, 181, 3, 69, "Subsection",ExpressionUUID->"a07000db-628e-4124-b2a7-df72af4ef85e"],
Cell[20610, 563, 1574, 42, 163, "Input",ExpressionUUID->"56d9cfa7-f17e-4ed1-955a-7ed236470ee5"],
Cell[22187, 607, 179, 3, 37, "Input",ExpressionUUID->"722da79d-c635-49d3-8eb7-c03440df476e"]
}, Open  ]]
}, Open  ]]
}
]
*)

